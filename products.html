<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Products</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">Marketplace</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="profile.html">Profile</a></li>
                    <li class="nav-item"><a class="nav-link" href="cart.html">Cart</a></li>
                    <li class="nav-item"><a class="nav-link" href="wishlist.html">Wishlist</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Search Bar -->
        <div class="mb-4">
            <input type="text" class="form-control" id="searchBar" placeholder="Search products...">
        </div>

        <div class="row">
            <!-- Sidebar Filters -->
            <div class="col-md-3">
                <h4>Filters</h4>
                <div class="mb-3">
                    <label class="form-label">Price Range</label>
                    <input type="range" class="form-range">
                </div>
                <div class="mb-3">
                    <label class="form-label">Brand</label>
                    <select class="form-select">
                        <option>All Brands</option>
                        <option>Brand A</option>
                        <option>Brand B</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label">Rating</label>
                    <select class="form-select">
                        <option>Any Rating</option>
                        <option>4 Stars & Up</option>
                        <option>3 Stars & Up</option>
                    </select>
                </div>
            </div>

            <!-- Product Listings -->
            <div class="col-md-9">
                <h2 class="mb-4">Products</h2>
                <div class="row" id="productList">
                    <div class="col-md-4">
                        <div class="card">
                            <img src="images/product1.jpg" class="card-img-top" alt="Product 1">
                            <div class="card-body text-center">
                                <h5 class="card-title">Product 1</h5>
                                <p class="card-text">$50.00</p>
                                <a href="product_details.html?product=1" class="btn btn-primary">View Details</a>
                                <a href="cart.html" class="btn btn-success">Add to Cart</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <img src="images/product2.jpg" class="card-img-top" alt="Product 2">
                            <div class="card-body text-center">
                                <h5 class="card-title">Product 2</h5>
                                <p class="card-text">$75.00</p>
                                <a href="product_details.html?product=2" class="btn btn-primary">View Details</a>
                                <a href="cart.html" class="btn btn-success">Add to Cart</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <img src="images/product3.jpg" class="card-img-top" alt="Product 3">
                            <div class="card-body text-center">
                                <h5 class="card-title">Product 3</h5>
                                <p class="card-text">$100.00</p>
                                <a href="product_details.html?product=3" class="btn btn-primary">View Details</a>
                                <a href="cart.html" class="btn btn-success">Add to Cart</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simple search function
        document.getElementById('searchBar').addEventListener('input', function() {
            let filter = this.value.toLowerCase();
            let products = document.querySelectorAll('#productList .col-md-4');
            
            products.forEach(product => {
                let title = product.querySelector('.card-title').innerText.toLowerCase();
                if (title.includes(filter)) {
                    product.style.display = "block";
                } else {
                    product.style.display = "none";
                }
            });
        });

        document.addEventListener("DOMContentLoaded", function () {
    const productList = document.getElementById("productList");
    const searchBar = document.getElementById("searchBar");
    const priceRange = document.querySelector(".form-range");
    const brandFilter = document.querySelector(".form-select:nth-of-type(1)");
    const ratingFilter = document.querySelector(".form-select:nth-of-type(2)");

    let products = []; // Store fetched products

    // Function to fetch products from API
    function fetchProducts() {
        fetch("product_api.php")
            .then(response => response.json())
            .then(data => {
                products = data.products; // Store products
                displayProducts(products); // Show products on page load
            })
            .catch(error => console.error("Error fetching products:", error));
    }

    // Function to display products
    function displayProducts(filteredProducts) {
        productList.innerHTML = ""; // Clear previous products

        filteredProducts.forEach(product => {
            const productCard = `
                <div class="col-md-4">
                    <div class="card">
                        <img src="${product.image}" class="card-img-top" alt="${product.name}">
                        <div class="card-body text-center">
                            <h5 class="card-title">${product.name}</h5>
                            <p class="card-text">$${product.price}</p>
                            <a href="product_details.html?product=${product.id}" class="btn btn-primary">View Details</a>
                            <button class="btn btn-success add-to-cart" data-id="${product.id}" data-name="${product.name}" data-price="${product.price}" data-image="${product.image}">Add to Cart</button>
                        </div>
                    </div>
                </div>
            `;
            productList.innerHTML += productCard;
        });

        // Attach event listeners to "Add to Cart" buttons
        document.querySelectorAll(".add-to-cart").forEach(button => {
            button.addEventListener("click", addToCart);
        });
    }

    // Function to add items to the cart
    function addToCart(event) {
        const button = event.target;
        const product = {
            id: button.getAttribute("data-id"),
            name: button.getAttribute("data-name"),
            price: button.getAttribute("data-price"),
            image: button.getAttribute("data-image"),
        };

        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        cart.push(product); // Add product to cart
        localStorage.setItem("cart", JSON.stringify(cart)); // Save to local storage

        alert(`${product.name} added to cart!`);
    }

    // Function to filter products
    function filterProducts() {
        let searchQuery = searchBar.value.toLowerCase();
        let selectedBrand = brandFilter.value;
        let selectedRating = ratingFilter.value;

        let filtered = products.filter(product => {
            return (
                product.name.toLowerCase().includes(searchQuery) &&
                (selectedBrand === "All Brands" || product.brand === selectedBrand) &&
                (selectedRating === "Any Rating" || product.rating >= parseInt(selectedRating[0]))
            );
        });

        displayProducts(filtered);
    }

    // Event listeners for filtering
    searchBar.addEventListener("input", filterProducts);
    brandFilter.addEventListener("change", filterProducts);
    ratingFilter.addEventListener("change", filterProducts);

    // Load products on page load
    fetchProducts();
});

    </script>

</body>
</html>
